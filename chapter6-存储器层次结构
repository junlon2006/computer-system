1、存储层级结构执行速度量化指标
CPU寄存器，指令执行时间约0个周期
高速缓存，执行时间4~75个周期
主存，执行时间几百周期
磁盘，执行时间几千万周期

2、计算机中的局部性属性
时间局部性
空间局部性
一个编程良好的程序倾向于展示良好的局部性
重复引用相同变量的程序有很好的时间局部性
对具有步长为k的引用模式程序，步长越小，空间局部越好，具有步长1的引用模式具有很好的空间局部性
循环体越小，循环迭代次数越多，局部性越好

3、SRAM和DRAM
SRAM比DRAM更快，速度在10X左右
1 bit SRAM需要更多的晶体管（6个）集成度低，DRAM 1个，SRAM更昂贵，价格1000X倍
SRAM存储在双稳态(bitstable)存储单元中，可以无限期的保持在两个不同的电压配置或状态之一，其他状态都不稳定
SRAM只要有电，它将永远地保持它的值，即使有干扰（电子噪音）
DRAM将每个bit位存储为对一个电容的充电，由于漏电将导致在10~100ms时间失去电荷，所有需要周期性读取再写入的方式刷新电容
SRAM主要应用于高速缓存存储器，DRAM用于主存，帧缓冲区

4、I/O总线
PCI模型，系统所有设备共享总线，一个时刻只能有一台设备访问这些线路，2010前广泛使用
PCIe总线，最大吞吐16GB/s，PCI最大吞吐533MB/s
CPU使用内存映射(memory-mapped I/O)与I/O设备通信，地址中有一块保留项为I/O设备通信使用，地址称为I/O port
DMA自己执行读写总线事物，不需要CPU干涉，DMA搬运完成后通过控制器向CPU发送中断信号(发信号到CPU芯片一个外部引脚)

5、SSD
SSD是一种基于闪存的存储技术
闪存由多个块组成(单个块由32~128页组成)，页的大小是512B~4KB。数据以页为单位读写
只有一页所属的块整个被擦除后才能写这一页(通常指块中所有数据位被置1)，块擦除后，块写入时可不需要再擦除进行一次写操作

大约100000次重写，快就将磨损坏，磨损后，就不能在使用。闪存层通过平均磨损(wear leveling)最大化每个快的寿命
擦除快需要1ms级别时间，访问页需要100us级别时间

6、存储技术趋势
增加密度(从而降低成本)比降低访问时间容易很多
SRAM性能滞后于CPU性能，性能差距再拉大
P=fCv2 （f时钟频率，C是电容，v是电压）电容C正比于面积（制程越小性能越优）当面积不变时，多核功耗保持不变，采用多个小内核取代单个大内核

7、缓存
存储器层次结构的中心思想是，对每个K层，位于K层的更快更小的存储设备作为位于K+1层更大更慢的存储设备的缓存
最小的缓存为最接近CPU的寄存器组
缓存命中、缓存不命中(替换策略LRU等)
高速缓存(S,E,B,m)组织 容量C=S*E*B
高速缓存的冲突不命中，当程序访问大小为2的幂数组时，直接映射高速缓存中通常会发生冲突不命中。抖动(thrash)导致速度下降2~3倍很常见
高速缓存常用地址的中间位来做索引，而不是最高位，这样可以保证相邻的块总是映射到不同的高速缓存行，能充分使用所有高速缓存空间

高速缓存参数的性能影响
不命中率：程序一定时间内，内存引用不命中的比例
命中率：命中的内存引用比例。1-不命中率
命中时间：高速缓存传输一个字到CPU所需的时间，L1缓存，一般为几个周期
不命中处罚：由于不命中，需要从更底层存储加载，比如L1不命中，L2一般需要10个周期

高速缓存大小的影响
较大的高速缓存可能会提高命中率，但大存储运行可能会增加命中时间
一次读取一个块大小
